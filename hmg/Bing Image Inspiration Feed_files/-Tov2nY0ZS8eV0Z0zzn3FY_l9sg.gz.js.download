var OverFlowMenu;(function(){function vt(r,f){var a;if(t){if(n&&n===u.getImageItemWrapper(r)){e();return}if(n=u.getImageItemWrapper(r),n){l&&(n.classList.contains("crpttl")?(l.classList.remove(tt),a=_qs(nt,n),l.href=a===null||a===void 0?void 0:a.getAttribute("href")):l.classList.add(tt));var o=r.getBoundingClientRect(),w=_d.documentElement.clientWidth-o.right>i.MenuRightSideMargin,b=_d.documentElement.clientHeight-o.bottom>i.MenuBottomSideMargin,v="initial",h="px",y=5;b?(t.style.bottom=v,t.style.top=_w.scrollY+o.bottom+5+h):(t.style.top=v,t.style.bottom=_w.innerHeight-o.top-_w.scrollY-10+h);w?(t.style.right=v,t.style.left=_w.scrollX+o.left+h):(t.style.left=v,t.style.right=_w.innerWidth-o.right-_w.scrollX-15+h);t.classList.remove(s);var p=t.getBoundingClientRect(),k=p.right,d=p.left;k>_w.innerWidth&&(t.style.right=y+h);d<0&&(t.style.left=y+h);r.setAttribute(g,"true");c&&f&&f.evtType&&f.evtType===ct&&c.focus()}}}function yt(){var i,t,r;n&&(i=u.processElement(n),t=u.tryParseJson(i.length>0?i[0]:null),t)&&(r={itemId:t.id||"",mid:t.mid||"",turl:t.turl||"",surl:t.purl||"",maw:t.tw||0,mah:t.th||0,imgurl:t.murl||"",entrypoint:"Image.Feed"},typeof EditorialToolTabs!="undefined"?(EditorialToolTabs.setupInternalMetaData("",!0,!0,r),EditorialToolTabs.imageClick(),o=_ge("adult_mm_mark_element")):typeof FlagFeedback!="undefined"&&FlagFeedback&&(FlagFeedback.metadata=r,FlagFeedback.c(),o=_ge("fbdialog_container")),e())}function pt(){if(r)try{var n=r.getBoundingClientRect(),t=(_w.innerHeight-n.height)*.95;r.style.top=t+"px";r.style.right="calc(50% - ".concat(n.width/2,"px)")}catch(i){return null}}function a(n){n?(r.classList.remove(i.ParentDislikedViewClass,s),r.classList.add(i.ClonedDislikedViewClass,i.DialogDislikedViewClass),pt()):(r.classList.add(i.ParentDislikedViewClass,s),r.classList.remove(i.ClonedDislikedViewClass,i.DialogDislikedViewClass),f=null,clearTimeout(h),h=null)}function wt(){n&&(u.processRequest("Dislike",u.processElement(n)),r)&&(f=n,a(!0),n.parentElement&&(n.parentElement.style.display="none"),ut(),ft(),sj_be(r,ht,ut),sj_be(r,st,ft),n.classList.add(i.DislikedImagesClass),n.classList.remove(v),e())}function it(){var r,t,i;n&&(t=bt(),t)&&(i=_qs(et,t),i)&&(i.textContent=(r=i.dataset)===null||r===void 0?void 0:r.rptimg,n.classList.add(ot),n.classList.remove(v),n.appendChild(t),t.classList.remove(s),o.getAttribute("data-dislikere")=="true"&&u.processRequest("Dislike",u.processElement(n)),e())}function bt(){var n=r===null||r===void 0?void 0:r.cloneNode(!0);return n?(n.classList.remove(i.ParentDislikedViewClass),n.classList.add(i.ClonedDislikedViewClass),n):null}function kt(){f&&(u.processRequest("Undislike",u.processElement(f)),f.classList.remove(i.DislikedImagesClass),f.classList.add(v),f.parentElement&&(f.parentElement.style.display="block"),a(!1))}function e(){var i;t.classList.add(s);n&&((i=_qs(b,n))===null||i===void 0?void 0:i.setAttribute(g,"false"),n=null)}function dt(t){var i,r;t.code==="Escape"&&((i=_qs(b,n))===null||i===void 0?void 0:i.focus(),e());t.code==="Tab"&&(r=sj_et(t),r==c&&t.shiftKey&&(sj_pd(t),p.focus()),r==p&&(sj_pd(t),c.focus()))}function gt(i){var r=sj_et(i),u=t==r||t.contains(r),f=o===null||o===void 0?void 0:o.contains(r),s=r===null||r===void 0?void 0:r.getAttribute("href");u||f||s===w||n&&e()}function rt(){n.focus();e()}function ut(){h!=null&&clearTimeout(h)}function ft(){h=setTimeout(function(){a(!1)},at)}function ii(n){if(n&&n[1]){var i=n[1];i.bind("Dislike",wt,!0);i.bind("dtmnu",vt,!0);i.bind("Report",yt,!0);i.bind("UndoDislike",kt,!0);i.bind("fdrefresh",ti,!0);i.bind("CloseDislike",function(){a(!1);typeof mmLog!="undefined"&&mmLog('{"T":"CI.Click","Name":"FeedPage","Txt":"DislikeDialog","ClickSrc":"Close","TS":'+sb_gt()+"}")},!0);sj_be(t,"keydown",dt)}}function ri(){sj_evt.unbind(k,rt);sj_evt.unbind(d,it)}var u=ImageFeedUtils,i=FeedConstants,t=_qs(i.ImageItemMenuSelector),et=".fdshl_s",v="isv",y="a.fddtmnu-row",c=_qs(y,t),p=_qs("".concat(y,":last-of-type"),t),r=_qs(".".concat(i.ParentDislikedViewClass)),ot="imgrptd",st="mouseleave",ht="mouseenter",ct="keydown",s="fdhide",w="#CA!dtmnu",b=".infact> a[href='".concat(w,"']"),k="flagfeedback_close",d="flagfeedback_submit",lt="focusin",g="aria-expanded",at=5e3,o,n=null,f=null,h=null,nt="a.comments,a.comment",l=_qs(nt,t),tt="hd",ni=function(n){sj_sp(n)},ti=function(){_w.location.reload()},ui=function(){sj_evt.bind("ClientLinkAction_Loaded",ii,!0);sj_evt.bind(k,rt,!0);sj_evt.bind(d,it,!0);sj_evt.bind("prismFocusChange",e,!0);sj_be(t,lt,ni);sj_be(_w,"beforeunload",ri);sj_be(sj_b,i.ClickEventName,gt)};ui()})(OverFlowMenu||(OverFlowMenu={}))